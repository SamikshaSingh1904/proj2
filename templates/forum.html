{#
  forum.html
  Authors: Samiksha Singh

  Purpose:
    Show a list of events with basic info and link each card
    to its event-specific page.
#}

{% extends "base.html" %}

{% block main_content %}
<div class="forum-container">
    <div class="forum-header">
        <div class="forum-header-left">
            <h1>Event Forums</h1>
            <p>Browse and join events happening in the clump community</p>
        </div>
        <div>
            {% if show_past %}
                <a href="{{ url_for('forum') }}" 
                    class="filter-btn">Show Upcoming Only
                </a>
            {% else %}
                <a href="{{ url_for('forum', show_past='true') }}" 
                    class="filter-btn">Show All Events
                </a>
            {% endif %}
        </div>
    </div>
    
    {% if events %}
        {% for event in events %}
        <div class="event-card" 
            data-url="{{ url_for('view_event_forum', eid=event.eid) }}">
            <div class="participant-section">
                <div class="participant-count">
                    {{ event.participant_count }}
                </div>
                <div class="participant-label">joined</div>
            </div>
            <div class="event-content">
                <div class="event-meta">
                    <span class="event-category 
                                {{ event.category.split()[0] }}">
                        {% if event.category == 'Carpooling' %}ğŸš—
                        {% elif event.category == 'Hobby & Fitness' %}ğŸ‹ï¸
                        {% elif event.category == 'Help & Support' %}ğŸŒ±
                        {% elif event.category == 'Study Groups' %}ğŸ“š
                        {% elif event.category == 'Social Events' %}ğŸ‰
                        {% endif %}
                        {{ event.category }}
                    </span>
                    Posted by <strong>{{ event.creator_name }}</strong>
                </div>
                <div class="event-title">{{ event.title }}</div>
                <div class="event-description">{{ event.desc }}</div>
                <div class="event-details">
                    ğŸ“… {{ event.date.strftime('%b %d, %Y') }} 
                    at {{ event.start_formatted }}
                    â€¢ ğŸ“ {{ event.city }}, {{ event.state }}
                    â€¢ <span class="capacity-indicator 
                                    {% if event.participant_count 
                                        >= event.cap %}
                                            full
                                    {% endif %}">
                        {{ event.participant_count }}/{{ event.cap }} 
                        spots filled
                    </span>
                </div>
                <div class="event-actions">
                    <span class="action-badge">
                        ğŸ’¬ {{ event.comment_count }} 
                        comment{{ 's' if event.comment_count != 1 else '' }}
                    </span>
                    <span class="action-badge">
                        ğŸ‘¥ {{ event.participant_count }} 
                        participant{% if event.participant_count != 1 %}s
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <h2>No {% if not show_past %}upcoming {% endif %}events</h2>
            <p>{% if show_past %}No events have been created yet!{% else %}
                No upcoming events. 
                <a href="{{ url_for('forum', show_past='true') }}" 
                    style="color: #2c3e50;">View past events
                </a>{% endif %}
            </p>
        </div>
    {% endif %}
</div>

<script src="{{ url_for('static', filename='forum.js') }}"></script>
{% endblock %}